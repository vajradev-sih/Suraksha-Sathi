<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Pre-Shift Vehicle Inspection</title>
<link href="https://fonts.googleapis.com/css2?family=Public+Sans:wght@400;700&display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet"/>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<style>
  body { min-height: max(884px, 100dvh); }
  #historyOverlay, #noteOverlay {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.3);
    z-index: 50;
  }
  #historyContent, #noteContent {
    background: white;
    max-width: 400px;
    margin: 10vh auto;
    border-radius: 0.75rem;
    padding: 1rem;
    box-shadow: 0 4px 15px rgba(0,0,0,0.3);
  }
  .progress-bar {
    transition: width 0.5s ease-in-out;
  }
  .bg-progress-green { background-color: #22c55e; } /* Green for progress */
</style>
</head>
<body class="bg-background-light font-sans">

<div class="relative flex h-auto min-h-screen w-full flex-col bg-background-light overflow-x-hidden">

  <!-- Header -->
  <div class="flex items-center bg-card p-4 pb-2 justify-between sticky top-0 z-10 shadow-sm">
    <button id="backBtn" class="text-text-primary flex size-12 shrink-0 items-center justify-center">
      <span class="material-symbols-outlined text-2xl">arrow_back</span>
    </button>
    <h1 class="text-text-primary text-lg font-bold flex-1 text-center">Pre-Shift Vehicle Inspection</h1>
    <button id="historyBtn" class="text-text-primary flex size-12 shrink-0 items-center justify-center">
      <span class="material-symbols-outlined text-2xl">history</span>
    </button>
  </div>

  <!-- Daily Completion -->
  <div class="px-4 pt-4">
    <div class="bg-card rounded-xl p-4 shadow-sm">
      <div class="flex justify-between items-center mb-2">
        <h2 class="text-text-primary text-base font-bold">Daily Completion</h2>
        <span id="dailyCompleted" class="text-text-secondary text-sm">0/7 Days</span>
      </div>
      <div id="dailyProgress" class="flex gap-1">
        <div class="flex-1 h-2 rounded-full bg-gray-300 progress-bar bg-progress-green"></div>
        <div class="flex-1 h-2 rounded-full bg-gray-300 progress-bar bg-progress-green"></div>
        <div class="flex-1 h-2 rounded-full bg-gray-300 progress-bar bg-progress-green"></div>
        <div class="flex-1 h-2 rounded-full bg-gray-300 progress-bar bg-progress-green"></div>
        <div class="flex-1 h-2 rounded-full bg-gray-300 progress-bar bg-progress-green"></div>
        <div class="flex-1 h-2 rounded-full bg-gray-300 progress-bar bg-progress-green"></div>
        <div class="flex-1 h-2 rounded-full bg-gray-300 progress-bar bg-progress-green"></div>
      </div>
      <p class="text-text-secondary text-xs mt-2">Your compliance streak this week.</p>
    </div>
  </div>

  <!-- Overall Progress -->
  <div class="flex flex-col gap-3 p-4">
    <div class="flex justify-between items-center">
      <p class="text-text-secondary text-sm font-normal">Overall Progress</p>
      <p id="overallProgressText" class="text-text-primary text-sm font-bold">0% completed</p>
    </div>
    <div class="rounded-full bg-gray-200">
      <div id="overallProgressBar" class="h-2 rounded-full bg-progress-green progress-bar" style="width:0%"></div>
    </div>
  </div>

  <!-- Checklist -->
  <div id="checklistContainer" class="px-4 flex-grow bg-card mx-4 rounded-xl shadow-sm overflow-hidden">
    <label class="flex gap-x-4 py-3 items-center">
      <input class="task-checkbox h-6 w-6 rounded-md border-gray-300 border-2" type="checkbox"/>
      <p class="text-text-primary text-base font-normal flex-1">Check tire pressure</p>
    </label>
    <div class="border-t border-gray-200"></div>
    <label class="flex gap-x-4 py-3 items-center">
      <input class="task-checkbox h-6 w-6 rounded-md border-gray-300 border-2" type="checkbox"/>
      <p class="text-text-primary text-base font-normal flex-1">Inspect hydraulic lines for leaks</p>
    </label>
    <div class="border-t border-gray-200"></div>
    <label class="flex gap-x-4 py-3 items-center">
      <input class="task-checkbox h-6 w-6 rounded-md border-gray-300 border-2" type="checkbox"/>
      <p class="text-text-primary text-base font-normal flex-1">Verify communication equipment</p>
    </label>
    <div class="border-t border-gray-200"></div>
    <label class="flex gap-x-4 py-3 items-center">
      <input class="task-checkbox h-6 w-6 rounded-md border-gray-300 border-2" type="checkbox"/>
      <p class="text-text-primary text-base font-normal flex-1">Check fluid levels (oil, coolant, etc.)</p>
    </label>
    <div class="border-t border-gray-200"></div>
    <label class="flex gap-x-4 py-3 items-center">
      <input class="task-checkbox h-6 w-6 rounded-md border-gray-300 border-2" type="checkbox"/>
      <p class="text-text-primary text-base font-normal flex-1">Inspect lights and signals</p>
    </label>
    <div class="border-t border-gray-200"></div>
    <label class="flex gap-x-4 py-3 items-center">
      <input class="task-checkbox h-6 w-6 rounded-md border-gray-300 border-2" type="checkbox"/>
      <p class="text-text-primary text-base font-normal flex-1">Test braking system</p>
    </label>
  </div>

  <!-- Footer Buttons -->
  <div class="sticky bottom-0 bg-background-light/80 backdrop-blur-sm p-4 mt-8 shadow-top flex flex-col gap-2">
    <div class="flex gap-3">
      <button id="addNoteBtn" class="flex min-w-[120px] items-center justify-center rounded-lg h-10 px-4 bg-blue-600 text-white gap-2 border-2 border-blue-700 hover:bg-blue-700 transition-colors">
        <span class="material-symbols-outlined text-xl">add_comment</span>
        <span>Add Note</span>
      </button>
    </div>
    <button id="submitBtn" class="w-full rounded-lg h-12 bg-red-600 text-white font-bold hover:bg-red-700 transition-colors">
      Submit Report
    </button>
  </div>
</div>

<!-- History Overlay -->
<div id="historyOverlay">
  <div id="historyContent">
    <h2 class="text-text-primary text-lg font-bold mb-2">Past Inspections</h2>
    <ul class="text-text-secondary text-sm">
      <li>Inspection 01 - 100% complete</li>
      <li>Inspection 02 - 85% complete</li>
      <li>Inspection 03 - 90% complete</li>
    </ul>
  </div>
</div>

<!-- Note Modal -->
<div id="noteOverlay">
  <div id="noteContent">
    <h2 class="text-text-primary text-lg font-bold mb-2">Add Note</h2>
    <textarea id="noteText" class="w-full border border-gray-300 rounded p-2 mb-2" rows="4" placeholder="Type your note here..."></textarea>
    <div class="flex justify-end gap-2">
      <button id="cancelNoteBtn" class="px-4 py-2 bg-gray-300 rounded hover:bg-gray-400">Cancel</button>
      <button id="saveNoteBtn" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">Save</button>
    </div>
  </div>
</div>

<script>
// Back button
document.getElementById("backBtn").addEventListener("click", ()=>{ history.back(); });

// History overlay show/hide
const historyBtn = document.getElementById("historyBtn");
const historyOverlay = document.getElementById("historyOverlay");
historyBtn.addEventListener("click", ()=>{ historyOverlay.style.display = "block"; });
historyOverlay.addEventListener("click", (e)=>{
  if(e.target === historyOverlay) historyOverlay.style.display = "none";
});

// Checkbox progress
const checkboxes = document.querySelectorAll(".task-checkbox");
const overallProgressBar = document.getElementById("overallProgressBar");
const overallProgressText = document.getElementById("overallProgressText");
const dailyCompletedText = document.getElementById("dailyCompleted");
const dailyBars = document.querySelectorAll("#dailyProgress .progress-bar");

function updateProgress() {
  let checked = 0;
  checkboxes.forEach(cb => checked += cb.checked ? 1 : 0);

  const percent = Math.round((checked / checkboxes.length) * 100);
  overallProgressBar.style.width = percent + "%";
  overallProgressText.textContent = percent + "% completed";

  dailyBars.forEach((bar, index) => {
    if(index < checked) bar.style.width = "100%";
    else bar.style.width = "0%";
  });

  dailyCompletedText.textContent = `${checked}/${checkboxes.length} Days`;
}

checkboxes.forEach(cb => cb.addEventListener("change", updateProgress));
updateProgress();

// Note modal
const addNoteBtn = document.getElementById("addNoteBtn");
const noteOverlay = document.getElementById("noteOverlay");
const cancelNoteBtn = document.getElementById("cancelNoteBtn");
const saveNoteBtn = document.getElementById("saveNoteBtn");
const noteText = document.getElementById("noteText");

addNoteBtn.addEventListener("click", ()=> { noteOverlay.style.display = "block"; });
cancelNoteBtn.addEventListener("click", ()=> { noteOverlay.style.display = "none"; });
saveNoteBtn.addEventListener("click", ()=>{
  const note = noteText.value.trim();
  if(note) alert("Note saved: " + note); // Replace with real save logic
  noteText.value = "";
  noteOverlay.style.display = "none";
});

// Submit Report
document.getElementById("submitBtn").addEventListener("click", ()=>{
  const checklistData = Array.from(checkboxes).map(cb => cb.checked);
  alert("Report submitted!\nChecklist status: " + checklistData.join(", "));
});
</script>
</body>
</html>
